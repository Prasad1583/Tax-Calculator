<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>English Phrases (Auto Reader)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .highlight {
      background-color: #c7d2fe;
      font-weight: bold;
    }
  </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans min-h-screen">

  <!-- Header -->
  <header class="bg-indigo-700 text-white text-center py-6 shadow-md">
    <h1 class="text-3xl font-bold">ðŸ“˜ English Phrasebook</h1>
    <p class="text-indigo-200 text-sm mt-1">Auto-highlight for immersive reading</p>
  </header>

  <!-- Main Content -->
  <main class="max-w-4xl mx-auto px-4 py-10 space-y-6">

    <!-- Dropdown -->
    <div class="flex justify-center">
      <select id="categorySelect" class="p-2 rounded border border-gray-300 shadow focus:outline-none focus:ring-2 focus:ring-indigo-400">
        <option disabled selected>Select a category</option>
      </select>
    </div>

    <!-- Phrase List -->
    <div id="phraseList" class="space-y-3 max-h-[65vh] overflow-y-auto p-2 bg-white rounded-xl shadow-inner border border-gray-100"></div>
  </main>


  <!-- Script -->
  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const select = document.getElementById('categorySelect');
      const phraseList = document.getElementById('phraseList');
      let scrollInterval = null;

      try {
        const response = await fetch('https://ornate-frangollo-d46c3a.netlify.app/phrases.json');
        const data = await response.json();

        // Populate dropdown
        for (const category in data) {
          const option = document.createElement('option');
          option.value = category;
          option.textContent = category;
          select.appendChild(option);
        }

        // Handle selection
        select.addEventListener('change', () => {
          loadPhrases(data[select.value]);
        });

        // Load and scroll through phrases
        function loadPhrases(phrases) {
          clearInterval(scrollInterval);
          phraseList.innerHTML = '';

          phrases.forEach((phrase, i) => {
            const p = document.createElement('div');
            p.className = 'p-4 text-sm bg-gray-50 rounded shadow-sm transition';
            p.textContent = phrase;
            p.id = 'phrase-' + i;
            phraseList.appendChild(p);
          });

          let index = 0;
          scrollInterval = setInterval(() => {
            const allPhrases = document.querySelectorAll('#phraseList > div');
            allPhrases.forEach(p => p.classList.remove('highlight'));

            const current = document.getElementById('phrase-' + index);
            if (current) {
              current.classList.add('highlight');
              current.scrollIntoView({ behavior: 'smooth', block: 'center' });
              index++;
              if (index >= allPhrases.length) clearInterval(scrollInterval);
            }
          }, 2500); // change every 2.5 seconds
        }
      } catch (err) {
        phraseList.innerHTML = `<p class="text-red-600 text-center">Error loading phrases. Try again later.</p>`;
        console.error(err);
      }
    });
  </script>
</body>
</html>
